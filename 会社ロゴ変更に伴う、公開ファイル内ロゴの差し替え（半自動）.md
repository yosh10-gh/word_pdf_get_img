## 背景
タイトルの通り、会社のロゴが近い未来に変わると発表。
.docx および .pdf の中に当社ロゴデータが入っているものを抽出し、差し替えたい
（出来なかったら無限の気合で頑張るしかない....）

1. ディレクトリを全てクロールし、.docx, .pdf ファイルを抽出
2. 抽出したものから、 imgファイル（pngとか？）が含まれているものだけをさらに抽出
3. 含まれているものだけをリストアップ
4. 新規Excelを作成し、リストアップした .docx および .pdf のディレクトリパスをA列に並べる
5. そのファイルに埋め込まれている img ファイル（および png）を、image1, image2, image3の順番に B列, C列, D列　と並べて表示（表示サイズは 100px × 100px）して、検索結果.xlsxは完成
6. 担当者（人間）が、検索結果.xlsxを目視で確認。
7. ロゴだと判断した箇所（image1 がロゴだとか image3 がロゴだとか）の指定と、どの新ロゴファイルで差し替えるかを指定し、修正した状態でedit_dataディレクトリに出力。
   order_edit_image.xlsx の
   - F列に修正先の画像（image1なのか, image2 なのか）を記載
   - G列にF列で指定した修正先に、なんの画像を差し替えたいかを記載（その画像の絶対パス）
   - H列に、修正先の画像の2つ目を記載
   - I列に、H列で指定した修正先に、なんの画像を差し替えたいかを記載（その画像の絶対パス）
   - 修正したい画像の分だけ、横に列が伸びていく
   
7. newlogoディレクトリの中に、newlogo.docx 達と、newlogo.pdf 達を出力。
   （pdfの画像差し替えはさすがに厳しいかな...???）

## テストデータの準備
こんな感じで、画像が入っている・入っていない wordファイル（.docx）とpdfファイル（.pdf）を準備。
そして、A1フォルダにも同じようにwordファイルやpdfファイルを格納しておきます。
これで、深い階層までクロールしてくれるかテストします。
![[Pasted image 20250603213017.png]]

## 実装（Cursor & Claude 4.0 sonet）
```
1. ディレクトリを全てクロールし、.docx, .pdf ファイルを抽出  
だけをまずは実装したい。なるべくシンプルで余計な事はしないで欲しい。  
これだけが出来るpython プログラムを実装して。
```
こんな感じで cursor上で claude 4.0 sonet へ指示したら、すぐに出来た...（すごい）
さらに、Excelで結果を出力してほしいと指示。
出来た（ホントスゴイ...）

![[Pasted image 20250603214349.png]]
続けて、2.を指示。このファイルの中で、画像が埋め込まれているものだけを抽出してほしい。

出来ちゃった....（text.docxが無く、imgと付くものしか抽出していないのが証拠）
どうやら、word検索→pdf検索の順番に処理しているみたい。
![[Pasted image 20250603214801.png]]
ここからが大勝負。このファイル達の中身のimgデータをB列、C列に表示させてもらいましょう。

出来た！！！！すごい！！！（この機能を実装するために使ったopenpyxlライブラリが一時ファイルの保持でエラーをしていましたが、それも claudeが修正してくれました💦）
![[Pasted image 20250603215826.png]]