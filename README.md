# Word/PDF 画像抽出ツール

会社ロゴ変更に伴う、公開ファイル内ロゴの差し替え作業を半自動化するツールです。

## 機能

1. **ファイル検索**: ディレクトリを再帰的にクロールして `.docx` と `.pdf` ファイルを抽出
2. **画像判定**: 抽出したファイルから画像が含まれているもののみを選別
3. **画像表示**: 埋め込まれている画像を Excel ファイルに一覧表示（100px×100px）
4. **結果出力**: ファイルパスと画像を含む検索結果をExcelファイルで出力

## 出力形式

- **A列**: ファイルパス
- **B列**: image1（最初の画像）
- **C列**: image2（2番目の画像）  
- **D列**: image3（3番目の画像）

## 動作環境

- Python 3.7+
- Windows/macOS/Linux

## セットアップ

1. **リポジトリのクローン**
   ```bash
   git clone <repository-url>
   cd word_pdf_get_img
   ```

2. **依存関係のインストール**
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

```bash
python file_extractor.py
```

プログラムを実行すると：
1. 現在のディレクトリ以下のすべての `.docx` と `.pdf` ファイルを検索
2. 画像が含まれているファイルのみを抽出
3. 各ファイルから画像を抽出してExcelファイルに表示
4. `画像含有ファイル検索結果.xlsx` または `検索結果_[timestamp].xlsx` を出力

## 対応形式

### ファイル形式
- `.docx` (Microsoft Word)
- `.pdf` (Portable Document Format)

### 画像形式
- JPEG/JPG
- PNG
- その他PIL対応形式（一部制限あり）

### 制限事項
- WDPファイル（Windows Media Photo）は未対応
- 暗号化されたPDFは空パスワードでの復号化のみ対応
- 画像サイズ上限: 10MB

## エラー対応

プログラムは以下のエラーに対して頑健に設計されています：

- ファイルアクセス権限エラー
- 壊れた/不正なファイル
- 未対応画像形式
- 暗号化されたPDF
- Excelファイルの書き込み権限エラー

エラーが発生した場合でも処理を継続し、可能な限り多くのファイルを処理します。

## ライセンス

MIT License

## 更新履歴

### Version 1.0.0
- 基本的なファイル検索機能
- 画像含有判定機能
- Excel出力機能
- エラーハンドリング強化 